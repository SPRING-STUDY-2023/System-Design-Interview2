# 7μ¥ νΈν…” μμ•½ μ‹μ¤ν…

## 1οΈβƒ£ λ¬Έμ  μ΄ν•΄ λ° μ„¤κ³„ λ²”μ„ ν™•μ •

### κΈ°λ¥ μ”κµ¬μ‚¬ν•­
- νΈν…” μ •λ³΄ νμ΄μ§€ ν‘μ‹
- κ°μ‹¤ μ •λ³΄ νμ΄μ§€ ν‘μ‹
- κ°μ‹¤ μμ•½ μ§€μ›
- νΈν…”μ΄λ‚ κ°μ‹¤ μ •λ³΄λ¥Ό μ¶”κ°€/μ‚­μ /κ°±μ‹ ν•λ” κ΄€λ¦¬μ νμ΄μ§€ μ§€μ›
- μ΄κ³Ό μμ•½ μ§€μ›

<br/>

### λΉ„κΈ°λ¥ μ”κµ¬μ‚¬ν•­
- λ†’μ€ μμ¤€μ λ™μ‹μ„± μ§€μ›
- μ μ ν• μ§€μ—° μ‹κ°„ (μµλ€ λ‡ μ΄λ” ν—μ©)

<br/>

### κ°λµμ  κ·λ¨ μ¶”μ •
- μ΄ 5,000κ° νΈν…”, 100λ§ κ°μ κ°μ‹¤μ΄ μλ‹¤κ³  κ°€μ •ν•λ‹¤.
- ν‰κ· μ μΌλ΅ κ°μ‹¤μ 70%κ°€ μ‚¬μ© μ¤‘μ΄κ³ , ν‰κ·  ν¬μ™ κΈ°κ°„μ€ 3μΌλ΅ κ°€μ •ν•λ‹¤.
- μΌμΌ μμƒ μμ•½ κ²¬μ = μ•½ 240,000 (1λ°±λ§ * 0.7 / 3)
- μ΄λ‹Ή μμ•½ κ±΄μ = μ•½ 3 (240,000 / ν•λ£¨μ— 10^5μ΄)
- μ‹μ¤ν… λ‚΄ λ¨λ“  νμ΄μ§€μ QPS (μµμΆ… λ‹¨κ³„ λ„λ‹¬ μ „ 90% μ‚¬μ©μλ” μ΄νƒν•λ” κ²ƒμΌλ΅ κ°€μ •)
  - νΈν…”/κ°μ‹¤ μƒμ„Έ νμ΄μ§€: μ•½ 300
  - μμ•½ μƒμ„Έ μ •λ³΄ νμ΄μ§€: μ•½ 30
  - κ°μ‹¤ μμ•½ νμ΄μ§€: μ•½ 3
 
<br/>

## 2οΈβƒ£ κ°λµμ  μ„¤κ³„μ• μ μ‹ λ° λ™μ κµ¬ν•κΈ°

### API μ„¤κ³„

#### νΈν…” κ΄€λ ¨ API

|API|μ„¤λ…|
|--|--|
|GET /v1/hotels/id|νΈν…”μ μƒμ„Έ μ •λ³΄ λ°ν™|
|POST /v1/hotels|μ‹ κ· νΈν…” μ¶”κ°€ (νΈν…” μ§μ›μ©)|
|PUT /v1/hotels/id|νΈν…” μ •λ³΄ κ°±μ‹  (νΈν…” μ§μ›μ©)|
|DELETE /v1/hotels/id|νΈν…” μ •λ³΄ μ‚­μ  (νΈν…” μ§μ›μ©)|

<br/>

#### κ°μ‹¤ κ΄€λ ¨ API

|API|μ„¤λ…|
|--|--|
|GET /v1/hotels/:id/rooms/id|κ°μ‹¤ μƒμ„Έ μ •λ³΄ λ°ν™|
|POST /v1/hotels/:id/rooms|μ‹ κ· κ°μ‹¤ μ¶”κ°€ (νΈν…” μ§μ›μ©)|
|PUT /v1/hotels/:id/rooms/id|κ°μ‹¤ μ •λ³΄ κ°±μ‹  (νΈν…” μ§μ›μ©)|
|DELETE /v1/hotels/:id/rooms/id|κ°μ‹¤ μ •λ³΄ μ‚­μ  (νΈν…” μ§μ›μ©)|

<br/>

#### μμ•½ κ΄€λ ¨ API

|API|μ„¤λ…|
|---|---|
|GET /v1/reservations|λ΅κ·ΈμΈ μ‚¬μ©μμ μμ•½ μ΄λ ¥ λ°ν™|
|GET /v1/reservations/id|νΉμ • μμ•½μ μƒμ„Έ μ •λ³΄ λ°ν™|
|POST /v1/reservations|μ‹ κ· μμ•½|
|DELETE /v1/reservations/id|μμ•½ μ·¨μ†|

<br/>

### λ°μ΄ν„° λ¨λΈ
- `κ΄€κ³„ν• λ°μ΄ν„°λ² μ΄μ¤`λ¥Ό μ„ νƒν•λ‹¤.
  - μ½κΈ° λΉλ„κ°€ μ“°κΈ° μ—°μ‚°μ— λΉ„ν•΄ λ†’μ€ μ‘μ—… νλ¦„μ„ μ μ§€μ›ν•λ‹¤.
  - ACID μ†μ„±μ„ λ³΄μ¥ν•λ‹¤.
  - λ°μ΄ν„°λ¥Ό μ‰½κ² λ¨λΈλ§ν•  μ μλ‹¤. (κµ¬μ΅°/κ΄€κ³„λ¥Ό μ•μ •μ μΌλ΅ μ§€μ›)
 
- μƒνƒ μ²μ΄λ„ λ‹¤μ΄μ–΄κ·Έλ¨ (for μμ•½ μƒνƒ)

  <img alt="image" width="500" src="https://github.com/user-attachments/assets/1bd3a43d-74bb-423a-8028-3fe74f7ab118" />

<br/>

### κ°λµμ  μ„¤κ³„μ•

<img alt="image" width="500" src="https://github.com/user-attachments/assets/539c6cd3-123b-4d65-9a3e-ff7141310ea4"/>

- μ‚¬μ©μ: κ°μ‹¤μ„ μμ•½ν•λ” λ‹Ήμ‚¬μ
- κ΄€λ¦¬μ(νΈν…”μ§μ›): κ΄€λ¦¬ μ‘μ—…μ„ μν–‰ν•  κ¶λ¦¬κ°€ μλ” νΈν…” μ§μ›
- CDN: μ •μ  μ»¨ν…μΈ λ¥Ό μΊμ‹ν•μ—¬ λ΅λ“ μ„±λ¥ κ°μ„ 
- κ³µκ° API κ²μ΄νΈμ›¨μ΄: μ™„μ „ κ΄€λ¦¬ν• μ„λΉ„μ¤
- λ‚΄λ¶€ API: μΉμΈλ νΈν…” μ§μ›λ§ μ‚¬μ© κ°€λ¥ν• API
- νΈν…” μ„λΉ„μ¤: νΈν…”/κ°μ‹¤μ— λ€ν• μƒμ„Έ μ •λ³΄ μ κ³µ
- μ”κΈ μ„λΉ„μ¤: λ―Έλμ— λ°›μ•„μ•Ό ν•  μ”κΈ λ°μ΄ν„°λ¥Ό μ κ³µ
- μμ•½ μ„λΉ„μ¤: μμ•½ μ”μ²­μ„ λ°›κ³  κ°μ‹¤μ„ μμ•½ν•λ” κ³Όμ •μ„ μ²λ¦¬
- κ²°μ  μ„λΉ„μ¤: κ³ κ°μ κ²°μ  μ²λ¦¬ (μ„±κ³µν•λ©΄ κ²°μ  μ™„λ£λ΅, μ‹¤ν¨ν•λ©΄ μΉμΈ μ‹¤ν¨λ΅ μƒνƒκ°’ μ—…λ°μ΄νΈ)
- νΈν…” κ΄€λ¦¬ μ„λΉ„μ¤: μΉμΈλ νΈν…” μ§μ›λ§ μ‚¬μ© κ°€λ¥ν• μ„λΉ„μ¤

<br/>

## 3οΈβƒ£ μƒμ„Έ μ„¤κ³„

### κ°μ„ λ λ°μ΄ν„° λ¨λΈ
- νΈν…”μ„ μμ•½ν•  λ• νΉμ • κ°μ‹¤μ΄ μ•„λ‹, κ°μ‹¤ μ ν•μ„ μμ•½ν•κ² λλ‹¤.
- roomIDλ” roomTypeIDλ΅ λ³€κ²½ν•λ‹¤.
  - room: κ°μ‹¤μ— κ΄€κ³„λ μ •λ³΄λ¥Ό λ‹΄λ”λ‹¤.
  - room_type_rate: νΉμ • κ°μ‹¤ μ ν•μ νΉμ • μΌμ μ”κΈ μ •λ³΄λ¥Ό λ‹΄λ”λ‹¤.
  - reservation: ν¬μ™κ° μμ•½ μ •λ³΄λ¥Ό λ‹΄λ”λ‹¤.
  - room_type_inventory: νΈν…”μ λ¨λ“  κ°μ‹¤ μ ν•μ„ λ‹΄λ”λ‹¤.
    - hotel_id: νΈν…” μ‹λ³„μ
    - room_type_id: κ°μ‹¤ μ ν• μ‹λ³„μ
    - date: μΌμ
    - total_inventory: μ΄ κ°μ‹¤ μμ—μ„ μΌμ‹μ μΌλ΅ μ μ™Έν• κ°μ‹¤ μλ¥Ό λΊ€ κ°’
    - total_reserved: μ§€μ •λ hotel_id, room_type_idμ— μμ•½λ λ¨λ“  κ°μ‹¤μ μ
   
- Q. μμ•½ λ°μ΄ν„°κ°€ λ‹¨μΌ λ°μ΄ν„°λ² μ΄μ¤μ— λ‹΄κΈ°μ— λ„λ¬΄ ν¬λ©΄ μ–΄λ–»κ² ν•  κ²ƒμΈκ°€?
  - ν„μ¬/ν–¥ν›„ μμ•½ λ°μ΄ν„°λ§ μ €μ¥ν•λ‹¤. (μμ•½ μ΄λ ¥μ€ μμ£Ό μ ‘κ·Όν•μ§€ μ•μΌλ―€λ΅ μ•„μΉ΄μ΄λΉ™ ν•κ±°λ‚ λƒ‰λ™ μ €μ¥μ†λ΅ μ®κΉ€)
  - λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μƒ¤λ”©ν•λ‹¤. (μƒ¤λ”© ν‚¤λ” hotel_id)
 
<br/>

### λ™μ‹μ„± λ¬Έμ 
1. κ°™μ€ μ‚¬μ©μκ°€ μμ•½ λ²„νΌμ„ μ—¬λ¬ λ² λ„λ¥Ό μ μλ‹¤.
   - ν΄λΌμ΄μ–ΈνΈ μΈ΅ κµ¬ν„: ν΄λΌμ΄μ–ΈνΈ μ”μ²­ μ „μ†΅ ν›„ `μμ•½` λ²„νΌμ„ λΉ„ν™μ„±ν™”μ‹ν‚¨λ‹¤.
   - λ©±λ“± API: μμ•½ API μ”μ²­μ— λ©±λ“± ν‚¤λ¥Ό μ¶”κ°€ν•λ‹¤. (ex. reservation_id)
  
2. μ—¬λ¬ μ‚¬μ©μκ°€ κ°™μ€ κ°μ‹¤μ„ λ™μ‹μ— μμ•½ν•λ ¤ ν•  μ μλ‹¤.
   - λΉ„κ΄€μ  λ½: μ‚¬μ©μκ°€ λ μ½”λ“λ¥Ό κ°±μ‹ ν•λ ¤κ³  ν•λ” μκ°„ μ¦‰μ‹ λ½μ„ κ±Έμ–΄ λ™μ‹ μ—…λ°μ΄νΈλ¥Ό λ°©μ§€ν•λ‹¤.
     - π‘ λ³€κ²½ μ¤‘μ΄κ±°λ‚ λ³€κ²½μ΄ λλ‚ λ°μ΄ν„°λ¥Ό κ°±μ‹ ν•λ” μΌμ„ λ§‰μ„ μ μλ‹¤.
     - π‘ κµ¬ν„μ΄ μ‰½κ³  λ¨λ“  κ°±μ‹  μ—°μ‚°μ„ μ§λ ¬ν™”ν•μ—¬ μ¶©λμ„ λ§‰λ”λ‹¤.
     - π‘ μ—¬λ¬ λ μ½”λ“μ— λ½μ„ κ±Έλ©΄ κµμ°© μƒνƒ(λ°λ“λ½)κ°€ λ°μƒν•  μ μλ‹¤.
     - π‘ ν™•μ¥μ„±μ΄ λ‚®λ‹¤. (μ„±λ¥μ  λ¬Έμ )
    
   - λ‚™κ΄€μ  λ½: μ—¬λ¬ μ‚¬μ©μκ°€ λ™μ‹μ— κ°™μ€ μμ›μ„ κ°±μ‹ ν•λ ¤ μ‹λ„ν•λ” κ²ƒμ„ ν—μ©ν•λ‹¤. (λ²„μ „ λ²νΈ μ‚¬μ©)
     - π‘ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μ ν¨ν•μ§€ μ•μ€ λ°μ΄ν„°λ¥Ό νΈμ§‘ν•λ” μΌμ„ λ§‰λ”λ‹¤.
     - π‘ λ°μ΄ν„°λ² μ΄μ¤ μμ›μ— λ½μ„ κ±Έ ν•„μ”κ°€ μ—†λ‹¤. (λ²„μ „ λ²νΈλ¥Ό ν†µν•΄ λ°μ΄ν„° μΌκ΄€μ„± μ μ§€)
     - π‘ λ°μ΄ν„°μ— λ€ν• κ²½μμ΄ μΉμ—΄ν•μ§€ μ•μ€ μƒν™©μ— μ ν•©ν•λ‹¤.
     - π‘ λ°μ΄ν„°μ— λ€ν• κ²½μμ΄ μΉμ—΄ν• μƒν™©μ—μ„λ” μ„±λ¥μ΄ μΆ‹μ§€ μ•λ‹¤.
     - μμ•½ QPSκ°€ μΌλ°μ μΌλ΅ λ†’μ§€ μ•κΈ° λ•λ¬Έμ— νΈν…” μμ•½ μ‹μ¤ν…μ—μ„ μ ν•©ν•λ‹¤.
    
   - λ°μ΄ν„°λ² μ΄μ¤ μ μ•½ μ΅°κ±΄ (total_inventroy - total_reserved >= 0)
     - π‘ κµ¬ν„μ΄ μ‰½λ‹¤.
     - π‘ λ°μ΄ν„°μ— λ€ν• κ²½μμ΄ μ‹¬ν•μ§€ μ•μ„ λ• μ λ™μ‘ν•λ‹¤.
     - π‘ λ°μ΄ν„°μ— λ€ν• κ²½μμ΄ μ‹¬ν•λ©΄ μ‹¤ν¨ν•λ” μ—°μ‚° μκ°€ κΈ‰κ²©ν λμ–΄λ‚λ‹¤.
     - π‘ λ°μ΄ν„°λ² μ΄μ¤ μ μ•½ μ΅°κ±΄μ€ μ• ν”λ¦¬μΌ€μ΄μ… μ½”λ“μ™€ λ‹¬λΌμ„ λ²„μ „μ„ ν†µμ ν•κΈ° μ–΄λ µλ‹¤.
     - π‘ μ μ•½ μ΅°κ±΄μ„ ν—μ©ν•μ§€ μ•λ” λ°μ΄ν„°λ² μ΄μ¤λ„ μλ‹¤.
     - λ°μ΄ν„°μ— λ€ν• κ²½μμ΄ μ‹¬ν•μ§€ μ•μ€ νΈν…” μμ•½ μ‹μ¤ν…μ—μ„ μ ν•©ν•λ‹¤.
    
<br/>

### μ‹μ¤ν… κ·λ¨ ν™•μ¥

#### λ°μ΄ν„°λ² μ΄μ¤ μƒ¤λ”©
- λ°μ΄ν„°λ² μ΄μ¤λ¥Ό μ—¬λ¬ λ€ λ‘κ³ , κ°κ°μ— λ°μ΄ν„°μ μΌλ¶€λ§ λ³΄κ΄€ν•λ„λ΅ ν•λ‹¤.
- hotel_idλ¥Ό μƒ¤λ”© μ΅°κ±΄μΌλ΅ μ“°λ©΄ μΆ‹λ‹¤. (λ€λ¶€λ¶„ μ§μλ” hotel_idλ¥Ό ν•„ν„°λ§ μ΅°κ±΄μΌλ΅ μ‚¬μ©ν•¨)

<br/>

#### μΊμ‹
- λ°μ΄ν„°λ¥Ό λ³΄κ΄€ν•  λ• λ‚΅μ€ λ°μ΄ν„°λ” μλ™μ μΌλ΅ μ†λ©Έλλ„λ΅ TTLμ„ μ„¤μ •ν•λ” κ²ƒμ΄ λ°”λμ§ν•λ‹¤.
- λ λ””μ¤(Redis)λ” ν•΄λ‹Ή μƒν™©μ— μ ν•©ν•λ‹¤.
- μ”μ²­ κ°€μ΄λ° μΌλ¶€λ§ μ”μ—¬ κ°μ‹¤ λ°μ΄ν„°λ² μ΄μ¤κ°€ μ²λ¦¬ν•κ³  λ‚λ¨Έμ§€λ” μΊμ‹κ°€ λ‹΄λ‹Ήν•λ‹¤.
  - μμ•½ μ„λΉ„μ¤: API μ κ³µ
  - μ”μ—¬ κ°μ‹¤ μΊμ‹: μ‚¬μ „μ— μ”μ—¬ κ°μ‹¤ μ •λ³΄λ¥Ό μΊμ‹μ— λ―Έλ¦¬ μ €μ¥ν•΄λ‘”λ‹¤.
  - μ”μ—¬ κ°μ‹¤ λ°μ΄ν„°λ² μ΄μ¤: μ”μ—¬ κ°μ‹¤ μμ— λ€ν• κ°€μ¥ μ‹ λΆ°μ„± μλ” μ •λ³΄κ°€ λ³΄κ΄€λλ‹¤.
  - π‘ λ°μ΄ν„°λ² μ΄μ¤ λ¶€ν•κ°€ ν¬κ² κ°μ†ν•λ‹¤.
  - π‘ λ†’μ€ μ„±λ¥μ„ λ³΄μ¥ν•λ‹¤.
  - π‘ λ°μ΄ν„°λ² μ΄μ¤μ™€ μΊμ‹ μ‚¬μ΄μ λ°μ΄ν„° μΌκ΄€μ„±μ„ 100% μ μ§€ν•κΈ°λ” μ–΄λ µλ‹¤.

<br/>

#### μ„λΉ„μ¤ κ°„ λ°μ΄ν„° μΌκ΄€μ„±
- λ°μ΄ν„° μΌκ΄€μ„± λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄
  - 2λ‹¨κ³„ μ»¤λ°‹(2PC): μ—¬λ¬ λ…Έλ“μ— κ±ΈμΉ μ›μμ  νΈλμ­μ… μ‹¤ν–‰μ„ λ³΄μ¦ν•λ” λ°μ΄ν„°λ² μ΄μ¤ ν”„λ΅ν† μ½
    - λ¨λ“  λ…Έλ“κ°€ μ„±κ³µν•λ“  μ‹¤ν¨ν•λ“  λ‘ μ¤‘ ν•λ‚λ΅ νΈλμ­μ…μ΄ λ§λ¬΄λ¦¬λλ„λ΅ λ³΄μ¦ν•λ‹¤.
    - ν• λ…Έλ“μ— μ¥μ• κ°€ λ°μƒν•λ©΄ λ³µκµ¬λ  λ•κΉμ§€ μ§„ν–‰μ΄ μ¤‘λ‹¨λλ‹¤.
    - ν•λ‚μ νΈλμ­μ…μ„ ν†µν•΄ ACID μ†μ„±μ„ λ§μ΅±μ‹ν‚¨λ‹¤.
   
  - μ‚¬κ°€(Saga): κ° λ…Έλ“μ— κµ­μ§€μ μΌλ΅ λ°μƒν•λ” νΈλμ­μ…μ„ ν•λ‚λ΅ μ—®μ€ κ²ƒ
    - μ–΄λ ν• νΈλμ­μ…μ΄λΌλ„ μ‹¤ν¨ν•λ©΄ κ·Έ μ΄μ „ νΈλμ­μ…μ κ²°κ³Όλ¥Ό μ „λ¶€ λλλ¦¬λ” νΈλμ­μ…λ“¤μ„ μμ°¨μ μΌλ΅ μ‹¤ν–‰ν•λ‹¤.
    - κ²°κ³Όμ  μΌκ΄€μ„±μ— μμ΅΄ν•λ‹¤.

<br/>

## 4οΈβƒ£ λ§λ¬΄λ¦¬
- κ°λµμ μΈ μ„¤κ³„μ•
  - API μ„¤κ³„
  - λ°μ΄ν„° λ¨λΈ μ΄μ•
  - μ‹μ¤ν… μ•„ν‚¤ν…μ² λ‹¤μ΄μ–΄κ·Έλ¨
 
- μƒμ„Έ μ„¤κ³„μ•
  - λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§ μ„¤κ³„μ• λ³€κ²½ (roomID -> roomTypeID)
  - κ²½μ μ΅°κ±΄ λ°μƒ μ΅°κ±΄ λ° ν•΄κ²°λ°©μ•
  - μ‹μ¤ν… κ·λ¨ ν™•μ¥ μ „λµ
    - λ°μ΄ν„°λ² μ΄μ¤ μƒ¤λ“±
    - λ λ””μ¤ μΊμ‹
   
  - λ°μ΄ν„° μΌκ΄€μ„± λ¬Έμ 
